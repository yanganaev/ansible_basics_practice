#####################################
# 1. Ansible Basics Practice Task 2 #
#####################################
---
- hosts: nodes
  vars:
   userlist:
    alice:
     email: Alice@example.com
     homedir: /home/alice
     password: !vault |
          $ANSIBLE_VAULT;1.1;AES256
          34386436656236623266343863376363653337313666316130626630666634316666356336313236
          3532643965646336633563636430313934643434633135330a303264333934666430623839353866
          66363762396235666663666363656130366130623865356264646362303566666363373864313139
          3462303131666134350a306562383661363534363162656132313965356433666239343838323030
          6138
 
    bob:
     email: Bob@example.com
     homedir: /home/bob
     password: !vault |
          $ANSIBLE_VAULT;1.1;AES256
          32626466623661616536316533336664393861373265316130656135323263626537663765316131
          6665383033336366343034643234366430373362666535330a356436663865393339366531373539
          30653830373833646366636132623865373933343232653666363731353432336338376263373132
          6166626234326638330a303661313565366537313936393361313435633263386166393262326434
          6236 

    carol:
     email: Carol@example.com
     homedir: /home/carol
     password: !vault |
          $ANSIBLE_VAULT;1.1;AES256
          33323535303730626339633739353733663339353936343430336266303962396635396463623562
          6363623266356464363632633362346334313365386365610a373430643037356234633934376237
          64303663363530613937333532386261613362363230336636363463613535376661383735373764
          3931643932646565370a623061306562313536396230336638646432386161613535373762373931
          3832

  tasks:
  - name: Adding users
    user:
      update_password: on_create
      create_home: yes
      state: present
      name: "{{item.key}}"
      comment: "{{item.value.email}}"
      home: "{{item.value.homedir}}"
      password: "{{item.value.password}}"
    with_dict: "{{ userlist }}"